function cardRefreshTimes(){var e=document.getElementById("card-widget-schedule");if(e){const a=new Date,t=a.getFullYear(),r=a.getMonth();date=a.getDate(),asideTime=new Date(t+"/01/01 00:00:00"),asideDay=(a-asideTime)/1e3/60/60/24;const n=t%4==0&&t%100!=0||t%400==0;dates=[31,n?29:28,31,30,31,30,31,31,30,31,30,31][r];let d=a.getDay(),s=0===d?6:d-1;console.log("cardRefreshTimes - asideDay:",asideDay,"date:",date,"dates:",dates),e.querySelector("#pBar_year").value=asideDay,e.querySelector("#p_span_year").innerHTML=(asideDay/365*100).toFixed(2)+"%",e.querySelector(".schedule-r0 .schedule-d1 .aside-span2").innerHTML="剩余<a> "+(365-asideDay).toFixed(0)+" </a>天",e.querySelector("#pBar_month").value=date,e.querySelector("#pBar_month").max=dates,e.querySelector("#p_span_month").innerHTML=(date/dates*100).toFixed(2)+"%",e.querySelector(".schedule-r1 .schedule-d1 .aside-span2").innerHTML="剩余<a> "+(dates-date)+" </a>天",e.querySelector("#pBar_week").value=s+1,e.querySelector("#p_span_week").innerHTML=((s+1)/7*100).toFixed(2)+"%",e.querySelector(".schedule-r2 .schedule-d1 .aside-span2").innerHTML="剩余<a> "+(7-(s+1))+" </a>天",e.classList.add("loaded")}else console.error("card-widget-schedule not found")}function cardTimes(){const e=new Date;year=e.getFullYear(),month=e.getMonth();let a=e.getDay();week=0===a?6:a-1,date=e.getDate();var t=document.getElementById("card-widget-calendar");if(t){var r=year%4==0&&year%100!=0||year%400==0;switch(week){case 0:weekStr="周一";break;case 1:weekStr="周二";break;case 2:weekStr="周三";break;case 3:weekStr="周四";break;case 4:weekStr="周五";break;case 5:weekStr="周六";break;case 6:weekStr="周日";break;default:console.log("异常情况")}switch(month){case 0:monthStr="1月",dates=31;break;case 1:monthStr="2月",dates=r?29:28;break;case 2:monthStr="3月",dates=31;break;case 3:monthStr="4月",dates=30;break;case 4:monthStr="5月",dates=31;break;case 5:monthStr="6月",dates=30;break;case 6:monthStr="7月",dates=31;break;case 7:monthStr="8月",dates=31;break;case 8:monthStr="9月",dates=30;break;case 9:monthStr="10月",dates=31;break;case 10:monthStr="11月",dates=30;break;case 11:monthStr="12月",dates=31;break;default:console.log("异常情况")}let a=new Date(year,month,1).getDay();var n,d=0===a?6:a-1,s="",o=!1,c=7-d,l=(dates-c)%7,i=0===l?Math.floor((dates-c)/7)+1:Math.floor((dates-c)/7)+2,u=t.querySelector("#calendar-main");let D=u.querySelectorAll("div[class^='calendar-r']");D.forEach(e=>{e.classList.contains("calendar-rh")||e.remove()});var y=t.querySelector("#calendar-date");switch(i){case 4:y.style.fontSize="36px";break;case 5:y.style.fontSize="48px";break;case 6:y.style.fontSize="64px";break;default:y.style.fontSize="64px"}for(let e=0;e<i;e++){let a=document.createElement("div");a.className="calendar-r"+e,u.appendChild(a);for(let t=0;t<7;t++)0===e&&t<d?a.innerHTML+="<div class='calendar-d"+t+"'><a> </a></div>":o&&s>dates?a.innerHTML+="<div class='calendar-d"+t+"'><a> </a></div>":(o||(s=1,o=!0),n=s===date?" class='now'":"",a.innerHTML+="<div class='calendar-d"+t+"'><a"+n+">"+s+"</a></div>",o&&s<=dates&&(s+=1))}var m=chineseLunar.solarToLunar(new Date(year,month,date));animalYear=chineseLunar.format(m,"A"),ganzhiYear=chineseLunar.format(m,"T").slice(0,-1),lunarMon=chineseLunar.format(m,"M"),lunarDay=chineseLunar.format(m,"d");var h=new Date("2026/06/01 00:00:00"),S=Math.floor((h-e)/1e3/60/60/24);asideTime=new Date(year+"/01/01 00:00:00"),asideDay=(e-asideTime)/1e3/60/60/24,asideDayNum=Math.floor(asideDay);let w=new Date(year,0,1).getDay(),g=0===w?6:w-1;var k=Math.floor((asideDayNum+g)/7)+1;t.querySelector("#calendar-week").innerHTML="本年第"+k+"周   "+weekStr,t.querySelector("#calendar-date").innerHTML=date.toString().padStart(2,"0"),t.querySelector("#calendar-solar").innerHTML=year+"年"+monthStr+" 第"+asideDay.toFixed(0)+"天",t.querySelector("#calendar-lunar").innerHTML=ganzhiYear+animalYear+"年 "+lunarMon+lunarDay;const M=document.getElementById("schedule-days");M&&(M.innerHTML=S>0?S:"已过")}}var year,month,week,date,dates,weekStr,monthStr,asideTime,asideDay,asideDayNum,animalYear,ganzhiYear,lunarMon,lunarDay;document.addEventListener("DOMContentLoaded",()=>{const e=()=>{const a=document.getElementById("card-widget-schedule"),t=document.getElementById("card-widget-calendar");a&&t?(console.log("DOM ready, updating cards"),cardTimes(),cardRefreshTimes()):(console.log("DOM not ready, retrying..."),setTimeout(e,50))};e()});